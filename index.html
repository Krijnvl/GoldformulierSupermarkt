<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gold Dry Bestelformulier</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">

<style>

.form-container {
  transform: scale(0.75);
  transform-origin: top center;
}

* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'Poppins', sans-serif;
  background: #1d1d1d;
  color: #FFF;
  line-height: 1.6;
  padding: 2rem;
}

#stepinfo {
  display: none;
}



.form-container {
  background: #171717;
  color: #FFF;
  max-width: 760px;
  margin: 0 auto;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.1);
  border: 1px solid #ddd;
}
.progress {
  text-align: right;
  margin-bottom: 1rem;
  color: #ffffff;
}
.back-btn,
#backBtn {
  margin-bottom: 0.5rem;
  background: none;
  border: none;
  font-size: 1rem;
  cursor: pointer;
  color: #ffffff;
}
.step { display: none; }
.step.active { display: block; }
#welcomeStep {
  text-align: center;
}
.welcome-img {
  max-width: 300px;
  width: 80%;
  height: auto;
  display: block;
  margin: 1rem auto;
}
#welcomeStep h2 {
  font-size: 2.2rem;
}
#welcomeStep p {
  font-size: 1.2rem;
}
label {
  display: block;
  margin-top: 0.25rem;
  font-weight: 500;
  text-align: left;
}
.form-field {
  width: 75%;
  margin: 1rem auto 0;
}
.product-group {
  width: 70%;
  margin: 3rem auto;
}
.product-group h4 {
  font-size: 1.3rem;
  margin-bottom: 1rem;
}
.section-divider {
  display: none;
}
input:not([type="checkbox"]):not([type="hidden"]),
select,
textarea {
  display: block;
  width: 100%;
  margin: 0.5rem 0;
  padding: 0.6rem 0.75rem;
  border: 1px solid #ccc;
  border-radius: 6px;
  background: #1d1d1d;
  color: #FFF;
  font-size: 1rem;
  font-family: inherit;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: #0066cc;
}
input[type="date"]::-webkit-calendar-picker-indicator {
  filter: invert(1);
}
input[readonly] {
  background: #eee;
  cursor: not-allowed;
}
button {
  margin-top: 1.5rem;
  padding: 0.75rem 1.2rem;
  border: none;
  border-radius: 6px;
  background: #c1b270;
  color: #000000;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 600;
  transition: background 0.2s;
}
button:hover {
  background: #c1b270;
}
.btn-group {
  display: flex;
  gap: 0.5rem;
  margin: 0.25rem 0 0.75rem;
  justify-content: flex-start;
}
.btn-group button {
  flex: 0 0 auto;
  width: 80px;
  background: #171717;
  color: #FFF;
  border: 1px solid #ccc;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  transition: background 0.2s;
}
.btn-group button:hover {
  background: #171717;
}
.btn-group button.active {
  border-color: #c1b270;
  border-width: 2px;
}
#xeXS {
  width: 20%;
}
.qty input[type="number"] {
  width: 30%;
}
.address-block,
.alt-address-block {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.75rem;
  margin-top: 0.5rem;
}
.product-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  margin-top: 1rem;
}
.product-item {
  border: 2px solid #ffffff;
  border-radius: 8px;
  padding: 1rem;
  text-align: center;
  background: #141414;
  color: #ffffff;
  transition: border-color 0.2s, background 0.2s;
}
.product-item label {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  cursor: pointer;
}
.product-item input[type="checkbox"] {
  display: none;
}
.product-item img {
  max-width: 100%;
  height: 180px;
  object-fit: contain;
  margin-bottom: 0.5rem;
}
.product-item:hover {
  border-color: #c1b270;
}
.product-item.checked {
  border-color: #c1b270;
  background: rgba(110, 226, 84, 0.15);
  box-shadow: 0 0 0 2px #6ee254 inset;
}

/* stronger outline for vodka, gin, and display cards */
#itemVodka,
#itemGin,
#itemDisplay {
  border-width: 3px;
}

/* remove white border when these items are checked */
#itemVodka.checked,
#itemGin.checked,
#itemDisplay.checked {
  border-color: #6ee254;
}
.qty { margin-top: 0.5rem; }
.qty-group { margin-top: 1rem; }
.warning { color: #e6b400; margin: 1rem 0; }
.summary-item strong { color: #e6b400; }
#signature {
  display: block;
  margin: 1rem auto;
  border: 2px dashed #000;
  background: #fff;
  cursor: crosshair;
  box-shadow: 0 0 4px rgba(0,0,0,0.2);
}
@media (max-width: 600px) {
  body { padding: 1rem; }
  .form-container { padding: 1rem; }
}
@media (max-width: 800px) {
  .product-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

#summary {
  padding-top: 1rem;
  font-size: 1.15rem;
  line-height: 1.6;
}

.overzicht-item {
  margin-bottom: 1.25rem;
  font-weight: 600;
}

.overzicht-totaal {
  font-size: 1.75rem;
  font-weight: 800;
  color: #ffffff;
}

#summary {
  max-width: 500px;
  margin: 2rem auto;
  background: #171717;
  color: #FFF;
  font-family: 'Poppins', sans-serif;
}

.summary-item {
  border-top: 1px solid #444;
  padding: 1rem 0;
  font-size: 1.1rem;
  font-weight: 600;
}

.summary-item span {
  display: block;
  margin-top: 0.25rem;
  font-weight: 400;
  font-size: 1rem;
}

.summary-total {
  margin-top: 2rem;
  font-size: 1.8rem;
  font-weight: 700;
  text-align: center;
  color: #fff;
}

input[type="date"] {
  min-width: 170px;       /* of bijvoorbeeld 240px */
  width: 100%;            /* laat het meegroeien met container */
  max-width: 250px;       /* stel optioneel een max in */
}

h3 {
  text-align: center;
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 2rem;
  color: #ffff
  ;
}


.step-header {
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  margin-bottom: 2rem;
}

.step-header #backBtn {
  position: absolute;
  left: 0;
  font-weight: 600;
  cursor: pointer;
  background: none;
  border: none;
  color: #fff;
  font-size: 1rem;
  padding: 0;
}

.step-header h3 {
  font-size: 2.2rem;
  font-weight: 700;
  color: #ffffff;
  margin: 0 auto;
}
.qty-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
  margin-bottom: 1.2rem;
}

.qty-row label {
  flex: 2;
  color: white;
  font-weight: 600;
  font-size: 1.1rem;
  white-space: nowrap;
}

.qty-row input {
  flex: 1;
  padding: 0.7rem;
  border-radius: 8px;
  border: 1px solid #ccc;
  background-color: #121212;
  color: white;
  font-size: 1rem;
  text-align: center;
}

.qty-price {
  width: 80px; /* üëà vaste breedte zorgt dat alle bedragen netjes uitgelijnd zijn */
  text-align: right;
  font-size: 1.1rem;
  color: #91e97b;
  font-weight: bold;
}

.extra-space {
  margin: 1.5rem 0;
}




input:invalid {
  border: 2px solid red;
}

.address-help {
  text-align: right;
  margin-top: 0.5rem;
}

.address-help a {
  font-size: 0.75rem;         /* iets kleiner */
  font-weight: 400;           /* normaal gewicht */
  text-decoration: underline;
  padding-right: 5.5rem; 
  color: #aaa;                /* lichter grijs voor minder contrast */
  opacity: 0.8;               /* iets transparanter */
  transition: all 0.2s ease;
}

.address-help a:hover {
  color: #fff;                /* bij hover iets opvallender */
  opacity: 1;
}

.popup {
  position: fixed;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  background: rgba(0, 0, 0, 0.4);
  z-index: 9999;
}

.popup.hidden {
  display: none;
}

.popup-box {
  background: #1c1c1c;
  padding: 2rem 2.5rem;
  border-radius: 14px;
  color: white;
  text-align: center;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
  max-width: 90%;
  width: 400px;
  animation: fadeIn 0.3s ease;
}

.popup-box.success {
  border-left: 5px solid #00e676;
}

.popup-box.error {
  border-left: 5px solid #d32f2f;
}

.whatsapp-button {
  display: inline-block;
  margin-top: 1rem;
  padding: 0.75rem 1.5rem;
  background-color: #25d366;
  color: white;
  text-decoration: none;
  border-radius: 8px;
  font-weight: bold;
  transition: background 0.3s;
}
.whatsapp-button:hover {
  background-color: #1ebc5e;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: scale(0.97);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

body {
  overflow-x: hidden;
  overflow-y: auto;
}

.form-container {
  max-height: 100%;
  overflow: hidden;
}

.product-item {
  position: relative;
  padding-bottom: 48px;
}

.product-title {
  margin-top: 6px;
  font-size: 0.9rem;
  color: #fff;
  font-weight: 500;
  line-height: 1.3;
}

.product-price {
  position: absolute;
  right: 12px;
  bottom: 12px;
  font-size: 0.78rem;
  color: rgba(255, 255, 255, 0.6);
  background: rgba(255, 255, 255, 0.06);
  padding: 4px 8px;
  border-radius: 6px;
  font-weight: 500;
  pointer-events: none;
}

#signature {
  display: block;
  margin: 1rem auto;
  border: 2px dashed #000;
  background: #fff;
  cursor: crosshair;
  box-shadow: 0 0 4px rgba(0, 0, 0, 0.2);
}

#clearSignatureBtn {
  margin-top: 1rem;
  padding: 0.75rem 1.2rem;
  border: none;
  border-radius: 6px;
  background: #c1b270;
  color: #000000;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 600;
  transition: background 0.2s;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

#clearSignatureBtn:hover {
  background: #b0a15c;
}

/* Foutieve invoervelden (input, select, textarea) */
input.error,
select.error,
textarea.error {
  border: 2px solid #ff4d4f;                    /* helder rood randje */
  background-color: #2b1a1a;                    /* donkere rode achtergrond */
  box-shadow: 0 0 6px rgba(255, 77, 79, 0.4);    /* zachte rode glow */
  transition: all 0.3s ease;
  color: #fff;                                   /* witte tekst voor contrast */
}

/* Foutmeldingstekst onder het veld */
.input-error-message {
  color: #ff4d4f;                                /* rood zoals veld */
  font-size: 0.8rem;
  font-weight: 500;
  margin-top: 0.3rem;
  padding-left: 0.25rem;
  animation: fadeInError 0.3s ease-in-out;
}

/* Fade-in animatie voor foutmeldingen */
@keyframes fadeInError {
  from {
    opacity: 0;
    transform: translateY(-3px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.popup-box.warning {
  border-left: 5px solid #ffcc00;
  background: #2b2b1f;
  color: #fff;
}

.popup-box.warning h2 {
  margin-bottom: 1rem;
  font-size: 1.6rem;
  color: #ffcc00;
}

.popup-box.warning button {
  margin-top: 1.5rem;
  padding: 0.6rem 1.2rem;
  background: #ffcc00;
  color: #000;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  font-size: 1rem;
  cursor: pointer;
  transition: background 0.3s;
}

.popup-box.warning button:hover {
  background: #e6b800;
}


  
@media (max-width: 600px) {
  .product-price {
    display: none !important;
  }

  .product-item img {
    height: auto !important;
    max-height: 240px !important;
    width: 100% !important;
    object-fit: contain;
    margin-bottom: 0.75rem;
  }

  .product-item label {
    padding-top: 1rem;
  }

  .product-grid {
    grid-template-columns: 1fr !important; /* 1 blik per rij op mobiel */
  }
}

.bevestiging-tekst {
  max-width: 700px;
  margin: 1.5rem auto;
  padding: 0 1.5rem;
  font-size: 1rem;
  line-height: 1.6;
  text-align: justify;
  color: #e6b400;
}

@media (max-width: 600px) {
  .bevestiging-tekst {
    padding: 0 1rem;
    font-size: 0.95rem;
  }
}

.handtekening-label {
  text-align: center;
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 0.75rem;
  color: #fff;
}

.handtekening-container {
  max-width: 500px;
  margin: 1rem auto 0;
  text-align: center;
}

.handtekening-container canvas {
  width: 100%;
  max-width: 400px;
  height: auto;
  aspect-ratio: 2 / 1;
  border: 2px dashed #fff;
  background: #fff;
  cursor: crosshair;
  display: block;
  margin: 0 auto;
  box-shadow: 0 0 4px rgba(0, 0, 0, 0.2);
}

.clear-link {
  text-align: right;
  max-width: 400px;
  margin: 0.5rem auto 1rem;
}

.clear-link a {
  color: #aaa;
  font-size: 0.85rem;
  text-decoration: underline;
  transition: color 0.2s;
}

.clear-link a:hover {
  color: #fff;
}

.button-wrapper {
  text-align: center;
  margin-top: 1.5rem;
}

.button-wrapper button {
  padding: 0.75rem 1.5rem;
  background: #c1b270;
  color: #000;
  font-weight: 600;
  font-size: 1rem;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s;
}

.button-wrapper button:hover {
  background: #b0a15c;
}



</style>
</head>
<body>
  <div class="form-container">

    <div class="step-header">
      <button type="button" id="backBtn" onclick="prevStep()" style="display: none;">&#8592; Terug</button>
    </div>
  
    <div id="progress" class="progress"><span id="stepinfo"></span></div>
  
    <form id="orderForm">
<div class="step active" id="welcomeStep">
  <h2>Gold Dry - Supermarkt</h2>
  <p>Vul hier jouw bestelling voor Gold Dry in.</p>
  <button type="button" onclick="nextStep()">Start</button>
</div>
<div class="step" id="klantStep">
  <h3>Klantgegevens</h3>
  <div class="form-field">
    <label>Naam bedrijf: *
      <input id="companyName" name="companyName" required>
    </label>
  </div>
  <div class="form-field">
    <label for="2fC3">Filiaal ID: *</label>
    <input 
      id="2fC3" 
      name="filiaalId" 
      oninput="lookupFiliaal()" 
      required 
      placeholder="Bijv. 3201" 
      disabled 
      style="background-color: #333; color: #888;"
    >
  
    <!-- Laadstatus tekst -->
    <div id="filiaalLoader" style="font-size: 0.85rem; color: #aaa; margin-top: 0.4rem;">
      Laden winkeldata...
    </div>
  
    <!-- Voortgangsbalk container -->
    <div id="progressBarContainer" style="width: 100%; height: 8px; background: #2a2a2a; border-radius: 4px; overflow: hidden; margin-top: 6px;">
      <div id="progressBar" style="width: 0%; height: 100%; background: gold; transition: width 0.3s;"></div>
    </div>
  </div>
  
  
  
  <div class="form-field">
    <div class="address-block">
      <label>Postcode: *
        <input id="postcode" name="postcode" required>
      </label>
      <label>Adres: *
        <input id="address" name="address" required>
      </label>
      <label>Plaats: *
        <input id="city" name="city" required>
      </label>
      <label>Provincie: *
        <input id="provincie" name="provincie" required>
      </label>
    </div>
  </div>
  
  <div class="address-help">
    <a href="https://wa.me/31644103175?text=Hi,%20mijn%20adres%20lijkt%20niet%20te%20kloppen.%20Kunnen%20jullie%20dit%20checken?"
       target="_blank">Kloppen de gegevens niet?</a>
  </div>
  
  <div class="form-field">
    <label>Voornaam: *
      <input id="gWe8" name="firstName" required>
    </label>
  </div>
  <div class="form-field">
    <label>Achternaam: *
      <input id="ajwm" name="lastName" required>
    </label>
  </div>
  <div class="form-field">
    <label>Email: *
      <input id="email" type="email" name="email" required>
    </label>
  </div>
  <div class="form-field">
    <label>Telefoonnummer: *
      <input id="phone" name="phone" required>
    </label>
  </div>
  <div class="form-field">
    <label>BTW-ID (Belgische klanten):
      <input id="btw" name="btw">
    </label>
  </div>
  <div class="form-field">
    <button type="button" onclick="nextStep()">Next</button>
  </div>
</div>
<div class="step" id="infoStep">
  <h3>Informatie</h3>
  <div class="form-field">
    <label>Datum doorvoeren: *
      <input id="xeXS" type="date" name="datum" required onclick="if(this.showPicker)this.showPicker()">
    </label>
  </div>
  <div class="form-field">
    <label>Afwijkende openingstijden: *</label>
    <div class="btn-group">
      <input type="hidden" id="meqN" name="afwijkende" value="" class="required-toggle">
      <button type="button" onclick="setToggle('meqN','Ja',this)">Ja</button>
      <button type="button" onclick="setToggle('meqN','Nee',this)">Nee</button>
    </div>
  </div>
  
  <div class="form-field">
    <label>Is de facturatie e-mail hetzelfde als de bevestiging e-mail? *</label>
    <div class="btn-group">
      <input type="hidden" id="aDP7" name="facturEmailSame" value="" class="required-toggle">
      <button type="button" onclick="setToggle('aDP7','Ja',this);toggleFacturEmail()">Ja</button>
      <button type="button" onclick="setToggle('aDP7','Nee',this);toggleFacturEmail()">Nee</button>
    </div>
  </div>
  <div class="form-field" id="facturEmailRow" style="display:none">
    <label>Facturatie e-mail: *
      <input id="qsmD" type="email" name="facturEmail">
    </label>
  </div>
  <div class="form-field">
    <label>Is het facturatie-adres hetzelfde als het verzendadres? *</label>
    <div class="btn-group">
      <input type="hidden" id="ftcZ" name="facturAdresSame" value="" class="required-toggle">
      <button type="button" onclick="setToggle('ftcZ','Ja',this);toggleAltAdres()">Ja</button>
      <button type="button" onclick="setToggle('ftcZ','Nee',this);toggleAltAdres()">Nee</button>
    </div>
  </div>
  <div class="form-field">
    <div id="altAdres" class="alt-address-block" style="display:none">
      <label>Adres:
        <input id="altStraat" name="altStraat">
      </label>
      <label>Plaats:
        <input id="altPlaats" name="altPlaats">
      </label>
      <label>Postcode:
        <input id="altPostcode" name="altPostcode">
      </label>
      <label>Provincie:
        <input id="altProvincie" name="altProvincie">
      </label>
    </div>
  </div>
  <div class="form-field">
    <label>Hebben jullie in het verleden Gold Dry gevoerd?</label>
    <div class="btn-group">
      <input type="hidden" id="m89Y" name="nieuwVerkooppunt" value="" class="required-toggle">
      <button type="button" onclick="setToggle('m89Y','Nee',this)">Ja</button>
      <button type="button" onclick="setToggle('m89Y','Ja',this)">Nee</button>
    </div>
  </div>

  <div class="form-field">
    <label>Persoonlijke uitlevering door Binc?</label>
    <div class="btn-group">
      <input type="hidden" id="tZd9" name="zelfUitleveren" value="" class="required-toggle">
      <button type="button" onclick="setToggle('tZd9','Ja',this)">Ja</button>
      <button type="button" onclick="setToggle('tZd9','Nee',this)">Nee</button>
    </div>
  </div>
  
  <div class="form-field">
    <button type="button" onclick="nextStep()">Next</button>
  </div>
</div>

<div class="step" id="productStep">
  <h3>Bestelling</h3>
  <div class="product-group">
    <h2>Gold Dry Premium Soda</h2>
    <div class="product-grid">
      <div class="product-item" id="itemOriginal">
        <label>
          <input type="checkbox" id="sodaOriginal" onchange="toggleQty('sodaOriginalQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-itMy/1dCMJZyuqd9ptL28TAWNKV/Original-Blik-1024x1024-(1).png?a=eV7eehJnrGnZZ74JJ4hoDz" alt="Gold Dry Original">
          <div>Gold Dry Original 250ml (24 HE)</div>
        </label>
        <div class="product-price">‚Ç¨26,88 per tray</div>
      </div>

      <div class="product-item" id="itemMindset">
        <label>
          <input type="checkbox" id="sodaMindset" onchange="toggleQty('sodaMindsetQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-itMy/fPkuady7zxrWFUsWDMbHKR/Mindset-Blik-1024x1024-(1).png?a=gkCrw8SaXeKAz1YC3KAxLj" alt="Gold Dry Mindset">
          <div>Gold Dry Mindset 250ml (24 HE)</div>
        </label>
        <div class="product-price">‚Ç¨26,88 per tray</div>
      </div>

      <div class="product-item" id="itemDream">
        <label>
          <input type="checkbox" id="sodaDream" onchange="toggleQty('sodaDreamQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-itMy/qF7nbuNm2vHPiWgWpTqmYc/Dream-Blik-1024x1024-(1).png?a=egRsWarXyKSRs6xsyfZPuv" alt="Gold Dry Dream">
          <div>Gold Dry Dream 250ml (24 HE)</div>
        </label>
        <div class="product-price">‚Ç¨26,88 per tray</div>
      </div>

      <div class="product-item" id="itemSky">
        <label>
          <input type="checkbox" id="sodaSky" onchange="toggleQty('sodaSkyQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-itMy/1enAgx5R42DMzbknaqAVzg/Sky-Blik-1024x1024-(1).png?a=8KuktjE9MoiZ8zcWnxjcFV" alt="Gold Dry Sky">
          <div>Gold Dry Sky 250ml (24 HE)</div>
        </label>
        <div class="product-price">‚Ç¨26,88 per tray</div>
      </div>

          <div class="product-item" id="itemEclipseSoda">
            <label>
              <input type="checkbox" id="sodaEclipse" onchange="toggleQty('sodaEclipseQty', this)">
              <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-itMy/emhq58112G6VrYDfu8EgJ9/Eclipse-Soda-Photoroom.png?a=9FXJr7q2Dz9EDpHNGgGrQB" alt="Gold Dry Eclipse">
              <div>Gold Dry Eclipse 250ml (24 HE)</div>
            </label>
            <div class="product-price">‚Ç¨26,88 per tray</div>
          </div>
    </div>

    <div class="qty-group">
      <div id="sodaOriginalQty" class="qty" style="display:none">
        <label style="display:flex; gap: 0.75rem; align-items:center;">
          <span>Aantal 24x Original:</span>
          <span id="op9uTotal" style="width: 80px; text-align:right; font-size:0.9rem; color:#a3d77a;">‚Ç¨0,00</span>
        </label>
        <input 
          id="op9u" 
          type="number" 
          min="0" 
          inputmode="numeric" 
          pattern="[0-9]*" 
          value="0"
          onfocus="clearIfZero(this)" 
          onblur="resetIfEmpty(this)" 
          oninput="filterToNumbers(this); updateTotal('op9u', 26.88)">
      </div>
      
          
<div id="sodaMindsetQty" class="qty" style="display:none">
  <label style="display:flex; gap: 0.75rem; align-items:center;">
    <span>Aantal 24x Mindset:</span>
    <span id="kg3wTotal" style="width: 80px; text-align:right; font-size:0.9rem; color:#a3d77a;">‚Ç¨0,00</span>
  </label>
  <input 
    id="kg3w" 
    type="number" 
    min="0" 
    inputmode="numeric" 
    pattern="[0-9]*" 
    value="0"
    onfocus="clearIfZero(this)" 
    onblur="resetIfEmpty(this)" 
    oninput="filterToNumbers(this); updateTotal('kg3w', 26.88)">
</div>

          
          <div id="sodaDreamQty" class="qty" style="display:none">
            <label style="display:flex; gap: 0.75rem; align-items:center;">
              <span>Aantal 24x Dream:</span>
              <span id="79KiTotal" style="width: 90px; text-align:right; font-size:0.9rem; color:#a3d77a;">‚Ç¨0,00</span>
            </label>
            <input 
              id="79Ki" 
              type="number" 
              min="0" 
              inputmode="numeric" 
              pattern="[0-9]*" 
              value="0"
              onfocus="clearIfZero(this)" 
              onblur="resetIfEmpty(this)" 
              oninput="filterToNumbers(this); updateTotal('79Ki', 26.88)">
          </div>
          
          
          <div id="sodaSkyQty" class="qty" style="display:none">
            <label style="display:flex; gap: 0.75rem; align-items:center;">
              <span>Aantal 24x Sky:</span>
              <span id="qA18Total" style="width: 120px; text-align:right; font-size:0.9rem; color:#a3d77a;">‚Ç¨0,00</span>
            </label>
            <input 
              id="qA18" 
              type="number" 
              min="0" 
              inputmode="numeric" 
              pattern="[0-9]*" 
              value="0"
              onfocus="clearIfZero(this)" 
              onblur="resetIfEmpty(this)" 
              oninput="filterToNumbers(this); updateTotal('qA18', 26.88)">
          </div>
          
          
          <div id="sodaEclipseQty" class="qty" style="display:none">
            <label style="display:flex; gap: 0.75rem; align-items:center;">
              <span>Aantal 24x Eclipse:</span>
              <span id="ecl1Total" style="width: 90px; text-align:right; font-size:0.9rem; color:#a3d77a;">‚Ç¨0,00</span>
            </label>
            <input 
              id="ecl1" 
              type="number" 
              min="0" 
              inputmode="numeric" 
              pattern="[0-9]*" 
              value="0"
              onfocus="clearIfZero(this)" 
              onblur="resetIfEmpty(this)" 
              oninput="filterToNumbers(this); updateTotal('ecl1', 26.88)">
          </div>
          
          

    </div>
  </div>

  <div class="extra-space"></div>


  <div class="product-group">
    <h2>Gold Dry Soda &amp; Vodka Pre-mix 5,5%</h2>
    <div class="product-grid">
      <div class="product-item selected">
        <label>
          <input type="checkbox" id="mixMindset" onchange="toggleQty('mixMindsetQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-issB/qsFQ9KrinGy5mX48K9zz6U/Premix-Mindset-Blik-1024x1024-(1).png?a=1tTzg8cp5cqeqbM4dd62Qk" alt="Gold Dry Mindset & Vodka Pre-mix">
          <div>Gold Dry Mindset &amp; Vodka Pre-mix 250ml (24 HE)</div>
        </label>
        <div class="product-price">‚Ç¨35,28 per tray</div>
      </div>

      <div class="product-item">
        <label>
          <input type="checkbox" id="mixDream" onchange="toggleQty('mixDreamQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-issB/vYkhHfouFznhL7CficZYRt/Premix-Dream-Blik-1024x1024-(1).png?a=2xiyefyFwTtbEG8tccKTe4" alt="Gold Dry Dream & Vodka Pre-mix">
          <div>Gold Dry Dream &amp; Vodka Pre-mix 250ml (24 HE)</div>
        </label>
        <div class="product-price">‚Ç¨35,28 per tray</div>
      </div>

      <div class="product-item">
        <label>
          <input type="checkbox" id="mixSky" onchange="toggleQty('mixSkyQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-issB/kzmNEC9wHiZhAKepG2rq1c/Gold.Dry.Sky.Premix-fotor-bg-remover-20241203102635.png?a=qk1vFpvbQPwGUbqZgeSDsA" alt="Gold Dry Sky & Vodka Pre-mix">
          <div>Gold Dry Sky &amp; Vodka Pre-mix 250ml (24 HE)</div>
        </label>
   <div class="product-price">‚Ç¨35,28 per tray</div>
      </div>

          <div class="product-item" id="itemEclipseMix">
            <label>
              <input type="checkbox" id="mixEclipse" onchange="toggleQty('mixEclipseQty', this)">
              <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-issB/a5pE8D4vnZJ1AayCfQEGmH/Eclipse-Pre-Mix-Photoroom.png?a=fn3GSk321AUXWD4Lay13n6" alt="Gold Dry Eclipse Pre-Mix">
              <div>Gold Dry Eclipse &amp; Vodka Pre-mix 250ml (24 HE)</div>
            </label>
            <div class="product-price">‚Ç¨35,28 per tray</div>
          </div>
    </div>
    <div class="qty-group">
      <div id="mixOriginalQty" class="qty" style="display:none">
        <label style="display:flex; gap: 0.75rem; align-items:center;">
          <span>Aantal 24x Original Pre-Mix:</span>
          <span id="2yGPTotal" style="width: 80px; text-align:right; font-size:0.9rem; color:#a3d77a;">‚Ç¨0,00</span>
        </label>
        <input 
          id="2yGP" 
          type="number" 
          min="0" 
          inputmode="numeric" 
          pattern="[0-9]*" 
          value="0"
          onfocus="clearIfZero(this)" 
          onblur="resetIfEmpty(this)" 
          oninput="filterToNumbers(this); updateTotal('2yGP', 35.28)">
      </div>
      
          

          <div id="mixMindsetQty" class="qty" style="display:none">
            <label style="display:flex; gap: 0.75rem; align-items:center;">
              <span>Aantal 24x Mindset Pre-Mix:</span>
              <span id="woFYTotal" style="font-size: 0.9rem; color: #a3d77a; width: 80px; text-align: right; display: inline-block;">‚Ç¨0,00</span>
            </label>
            <input 
              id="woFY" 
              type="number" 
              min="0" 
              inputmode="numeric" 
              pattern="[0-9]*" 
              value="0"
              onfocus="clearIfZero(this)" 
              onblur="resetIfEmpty(this)" 
              oninput="filterToNumbers(this); updateTotal('woFY', 35.28)">
          </div>
          

          <div id="mixDreamQty" class="qty" style="display:none">
            <label style="display:flex; gap: 0.75rem; align-items:center;">
              <span>Aantal 24x Dream Pre-Mix:</span>
              <span id="iZPhTotal" style="font-size: 0.9rem; color: #a3d77a; width: 90px; text-align: right; display: inline-block;">‚Ç¨0,00</span>
            </label>
            <input 
              id="iZPh" 
              type="number" 
              min="0" 
              inputmode="numeric" 
              pattern="[0-9]*" 
              value="0"
              onfocus="clearIfZero(this)" 
              onblur="resetIfEmpty(this)" 
              oninput="filterToNumbers(this); updateTotal('iZPh', 35.28)">
          </div>
          

          <div id="mixSkyQty" class="qty" style="display:none">
            <label style="display:flex; gap: 0.75rem; align-items:center;">
              <span>Aantal 24x Sky Pre-Mix:</span>
              <span id="a4mQTotal" style="font-size: 0.9rem; color: #a3d77a; width: 120px; text-align: right; display: inline-block;">‚Ç¨0,00</span>
            </label>
            <input 
              id="a4mQ" 
              type="number" 
              min="0" 
              inputmode="numeric" 
              pattern="[0-9]*" 
              value="0"
              onfocus="clearIfZero(this)" 
              onblur="resetIfEmpty(this)" 
              oninput="filterToNumbers(this); updateTotal('a4mQ', 35.28)">
          </div>
          

          <div id="mixEclipseQty" class="qty" style="display:none">
            <label style="display:flex; gap: 0.75rem; align-items:center;">
              <span>Aantal 24x Eclipse Pre-Mix:</span>
              <span id="ecl2Total" style="font-size: 0.9rem; color: #a3d77a; width: 90px; text-align: right; display: inline-block;">‚Ç¨0,00</span>
            </label>
            <input 
              id="ecl2" 
              type="number" 
              min="0" 
              inputmode="numeric" 
              pattern="[0-9]*" 
              value="0"
              onfocus="clearIfZero(this)" 
              onblur="resetIfEmpty(this)" 
              oninput="filterToNumbers(this); updateTotal('ecl2', 35.28)">
          </div>
          
           


    </div>
  </div>
  <div class="extra-space"></div>
  <div class="product-group">
    <h4>Sterke drank (doos 6 flessen)</h4>
    <div class="product-grid">
      <div class="product-item" id="itemVodka">
        <label>
          <input type="checkbox" id="vodka" onchange="toggleQty('vodkaQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-oStN/qU86wRWVszRNXDRJ2XW1JQ/Gold_Dry_Vodka_Fles_600x655.png?a=353KRtzQbUoXjw5oyy4V6C" alt="Gold Dry Vodka">
          <div>Gold Dry Vodka 70cl (doos)</div>
        </label>
   <div class="product-price">‚Ç¨150,42 per doos</div>
          </div>

      <div class="product-item" id="itemGin">
        <label>
          <input type="checkbox" id="gin" onchange="toggleQty('ginQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-oStN/2hHqtUTF2JfEgbnRHh85sC/Gold_Dry_Gin.png?a=97HjdxTXZGSeLGaAqRJ69k" alt="Gold Dry Gin">
          <div>Gold Dry Gin 70cl (doos)</div>
        </label>
        <div class="product-price">‚Ç¨150,42 per doos</div>
      </div>

      <div class="product-item" id="itemGin">
        <label>
          <input type="checkbox" id="vodka3L" onchange="toggleQty('vodka3LQty', this)">
          <img src="https://images.fillout.com/orgid-113709/flowpublicid-jxeCCTXRn7us/widgetid-oStN/cjbK8C83xisU7dCLSAELzA/Gold-Dry-Fles-3L.png?a=gK3JnGc8HnTfUyTtzhE6QK" alt="Gold Dry 3L">
          <div>Gold Dry 3L (1 Fles)</div>
        </label>
 <div class="product-price">‚Ç¨135 per fles</div>
      </div>

    </div>

    
    <div class="qty-group">
      <div id="vodkaQty" class="qty" style="display:none">
        <label style="display:flex; gap: 0.75rem; align-items:center;">
          <span>Aantal 6x Vodka:</span>
          <span id="hdRiTotal" style="width: 100px; text-align:right; font-size:0.9rem; color:#a3d77a;">‚Ç¨0,00</span>
        </label>
        <input 
          id="hdRi" 
          type="number" 
          min="0" 
          inputmode="numeric" 
          pattern="[0-9]*" 
          value="0"
          onfocus="clearIfZero(this)" 
          onblur="resetIfEmpty(this)" 
          oninput="filterToNumbers(this); updateTotal('hdRi', 150.42)">
      </div>
      
          
          <div id="ginQty" class="qty" style="display:none">
            <label style="display:flex; gap: 0.75rem; align-items:center;">
              <span>Aantal 6x Gin:</span>
              <span id="4w6uTotal" style="width: 125px; text-align:right; font-size:0.9rem; color:#a3d77a;">‚Ç¨0,00</span>
            </label>
            <input 
              id="4w6u" 
              type="number" 
              min="0" 
              inputmode="numeric" 
              pattern="[0-9]*" 
              value="0"
              onfocus="clearIfZero(this)" 
              onblur="resetIfEmpty(this)" 
              oninput="filterToNumbers(this); updateTotal('4w6u', 150.42)">
          </div>
          

          <div id="vodka3LQty" class="qty" style="display:none">
            <label style="display:flex; gap: 0.75rem; align-items:center;">
              <span>Aantal Vodka 3L:</span>
              <span id="eFfETotal" style="width: 100px; text-align:right; font-size:0.9rem; color:#a3d77a;">‚Ç¨0,00</span>
            </label>
            <input 
              id="eFfE" 
              type="number" 
              min="0" 
              inputmode="numeric" 
              pattern="[0-9]*" 
              value="0"
              onfocus="clearIfZero(this)" 
              onblur="resetIfEmpty(this)" 
              oninput="filterToNumbers(this); updateTotal('eFfE', 135)">
          </div>
          
          
    </div>
  </div>


  <div class="form-field">
    <label>Overige Informatie:<br>
      <textarea id="Overige-Informatie" name="overige" rows="4" cols="40"
        placeholder="Bijv. promotie materiaal gewenst, levering op specifieke datum, of eerst bellen voor levering."></textarea>
    </label>
  </div>
  
  <div class="form-field">
    <button type="button" onclick="nextStep()">Next</button>
  </div>
</div>
<div class="step" id="overzichtStep">
  <h3>Overzicht</h3>
  <div class="order-confirmation"></div>
  <div id="summary"></div>
  <p class="warning bevestiging-tekst">
    Ik bevestig dat ik volledig op de hoogte ben van de aard van de bestelde producten en ga akkoord met de bijbehorende voorwaarden, inclusief prijzen, leveringsdata en eventuele andere relevante informatie. Deze verklaring is rechtsgeldig en dient als formele bevestiging van mijn intentie om de bovengenoemde producten van het merk Gold Dry aan te schaffen.
  </p>

  
  <p class="handtekening-label">Handtekening:</p>


  <div class="handtekening-container">
    <canvas id="signature" width="400" height="200"></canvas>
    <div class="clear-link">
      <a href="#" onclick="clearCanvas(); return false;">Handtekening wissen</a>
    </div>
  </div>
  
 
  
  
  <input type="hidden" id="signatureData" name="signatureData">

<div class="button-wrapper">
  <button type="button" id="submitBtn">Verstuur</button>
</div>

  
<!-- ‚úÖ Succes-popup -->
<div id="successPopup" class="popup hidden">
  <div class="popup-box success">
    <h2>‚úÖ Bestelling ontvangen!</h2>
    <p>Bedankt voor je bestelling. We gaan er direct mee aan de slag.</p>
  </div>
</div>

<!-- ‚ùå Mislukt-popup -->
<div id="errorPopup" class="popup hidden">
  <div class="popup-box error">
    <h2>‚ùå Er ging iets mis</h2>
    <p>Neem alsjeblieft contact op via WhatsApp.</p>
    <a href="https://wa.me/31132032643" target="_blank" class="whatsapp-button">üì± WhatsApp ons</a>
  </div>
</div>


<!-- ‚ö†Ô∏è Te laag bedrag-popup -->
<div id="warningPopup" class="popup hidden">
  <div class="popup-box warning">
    <h2>Minimale bestelwaarde</h2>
    <p>De minimale orderwaarde is ‚Ç¨100. Voeg extra producten toe om verder te gaan.</p>
    <button onclick="closeWarningPopup()">Sluiten</button>
  </div>
</div>

</div>

</form>
<div id="thankyou" class="step">
  <h3>Bedankt voor je bestelling</h3>
</div>
<script>
  function clearIfZero(el) {
    if (el.value === "0") el.value = "";
  }

  function resetIfEmpty(el) {
    if (el.value === "" || el.value === "0") {
      el.value = "0";
    } else {
      el.value = String(Number(el.value)); // verwijdert voorloopnullen
    }
  }

  function filterToNumbers(el) {
    el.value = el.value.replace(/[^0-9]/g, ''); // haal niet-nummers weg
  }
  
function toggleItem(checkbox) {
    const hiddenInput = document.getElementById("selectedDisplay");
    if (checkbox.checked) {
      hiddenInput.value = checkbox.value;
    } else {
      hiddenInput.value = "";
    }
  }


    let currentStep = 0;
    const steps = document.querySelectorAll('.step');
    const stepinfo = document.getElementById('stepinfo');
    const stepNames = ['Welkom','Klant','Informatie','Bestelling','Overzicht','Bedankt'];
   
    function validateCurrentStep() {
  const current = steps[currentStep];
  const inputs = current.querySelectorAll('input[required], select[required], textarea[required]');
  const toggleFields = current.querySelectorAll('.required-toggle');
  let isValid = true;

  // Verwijder eerdere foutmeldingen
  current.querySelectorAll('.input-error-message').forEach(el => el.remove());

  // Validatie van standaard inputs
  inputs.forEach(input => {
    const value = input.value.trim();
    const label = input.closest('label');

    const showError = () => {
      input.classList.add('error');
      if (label && !label.querySelector('.input-error-message')) {
        const errorMsg = document.createElement('div');
        errorMsg.className = 'input-error-message';
        errorMsg.innerText = 'Verplicht veld';
        label.appendChild(errorMsg);
      }
    };

    const clearError = () => {
      input.classList.remove('error');
      const existing = label?.querySelector('.input-error-message');
      if (existing) existing.remove();
    };

    if (!value) {
      showError();
      isValid = false;
    } else {
      clearError();
    }

    // Live validatie bij typen
    input.addEventListener('input', clearError);
  });

  // Validatie van toggle-velden
  toggleFields.forEach(field => {
    const value = field.value.trim();
    const container = field.closest('.form-field');

    if (!value) {
      field.classList.add('error');
      isValid = false;

      if (!container.querySelector('.input-error-message')) {
        const msg = document.createElement('div');
        msg.className = 'input-error-message';
        msg.textContent = 'Verplicht veld';
        container.appendChild(msg);
      }
    } else {
      field.classList.remove('error');
      const msg = container.querySelector('.input-error-message');
      if (msg) msg.remove();
    }
  });

  return isValid;
}




    const FIELD_MAP = {
      'companyName': 'ovaAcxsqY43L2RMvc86sD8',
      '2fC3': '2fC3',
      'postcode': '1Atc',
     'address': 'nNT3',
     'city': 'bNM6',
     'provincie': 'dL8N',
      'gWe8': 'gWe8',
      'ajwm': 'ajwm',
      'email': '89LDToPpr2rz4QegExGwNh',
      'phone': 'gpZNY2JUfJ8vJ4fofPZap8',
      'btw': '12XG',
      'xeXS': 'xeXS',
      'meqN': 'meqN',
      'aDP7': 'aDP7',
      'qsmD': 'qsmD',
      'ftcZ': 'ftcZ',
      'm89Y': 'm89Y',
      'tZd9': 'tZd9',
      'op9u': 'op9u',
      'kg3w': 'kg3w',
      '79Ki': '79Ki',
      'qA18': 'qA18',
      '2yGP': '2yGP',
      'woFY': 'woFY',
      'iZPh': 'iZPh',
      'a4mQ': 'a4mQ',
      'hdRi': 'hdRi',
      'eFfE': 'eFfE',
      'ecl1': '7eP6',
      'altPostcode': 'keB3',
      'altStraat': 'w8mm',
      'altPlaats': 'xmxh',
      'altProvincie': 'iVQj',
    'ecl2': '1ecL',
      '4w6u': '4w6u',
      'selectedDisplay': '2WAt',
      'Overige-Informatie': '8KKH',
    };
    
    const QIDS = {
  'companyName': 'ovaAcxsqY43L2RMvc86sD8',
  '2fC3': '2fC3',
  'postcode': '1Atc',
  'address': 'nNT3',
  'city': 'bNM6',
  'provincie': 'dL8N',
  'gWe8': 'gWe8',
  'ajwm': 'ajwm',
  'email': '89LDToPpr2rz4QegExGwNh',
  'phone': 'gpZNY2JUfJ8vJ4fofPZap8',
  'btw': '12XG',
  'xeXS': 'xeXS',
  'meqN': 'meqN',
  'aDP7': 'aDP7',
  'qsmD': 'qsmD',
  'ftcZ': 'ftcZ',
  'm89Y': 'm89Y',
  'tZd9': 'tZd9',
  'op9u': 'op9u',
  'kg3w': 'kg3w',
  '79Ki': '79Ki',
  'qA18': 'qA18',
  '2yGP': '2yGP',
  'woFY': 'woFY',
  'eFfE': 'eFfE',
  'iZPh': 'iZPh',
  'a4mQ': 'a4mQ',
  'hdRi': 'hdRi',
  'ecl1': '7eP6',
  'ecl2': '1ecL',
  '4w6u': '4w6u',
  'selectedDisplay': '2WAt',
  'Overige-Informatie': '8KKH',
};
    
    function showStep(n) {
      steps.forEach((step, i) => step.classList.toggle('active', i === n));
      if (n < steps.length - 1) {
        stepinfo.textContent = `Stap ${n + 1}/${steps.length - 1} - ${stepNames[n]}`;
        stepinfo.style.display = '';
      } else {
        stepinfo.style.display = 'none';
      }
      document.getElementById('backBtn').style.display = n > 0 && n < steps.length - 1 ? 'inline' : 'none';
    }

    function nextStep() {
  if (!validateCurrentStep()) return;
  steps[currentStep].classList.remove('active');
  currentStep++;
  showStep(currentStep);
}


    function prevStep() {
      if (currentStep > 0) {
        currentStep--;
        showStep(currentStep);
      }
    }
    
    function setToggle(id, value, btn) {
      const input = document.getElementById(id);
      input.value = value;
      const group = btn.parentElement;
      group.querySelectorAll('button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }
    
    function toggleFacturEmail() {
      const sel = document.getElementById('aDP7').value;
      document.getElementById('facturEmailRow').style.display = sel === 'Nee' ? 'block' : 'none';
    }
    
    function toggleAltAdres() {
      const sel = document.getElementById('ftcZ').value;
      document.getElementById('altAdres').style.display = sel === 'Nee' ? 'block' : 'none';
    }
    
    function toggleQty(id, cb) {
  const el = document.getElementById(id);
  if (!el) return;

  const input = el.querySelector('input[type="number"]');

  if (cb.checked) {
    el.style.display = 'block';
  } else {
    el.style.display = 'none';
    if (input) {
      input.value = "0";
      input.dispatchEvent(new Event('input')); // zorgt dat totalen en overzicht updaten
    }
  }

  const item = cb.closest('.product-item');
  if (item) item.classList.toggle('checked', cb.checked);
}

    function toggleItem(cb) {
      const item = cb.closest('.product-item');
      if (item) item.classList.toggle('checked', cb.checked);
    }
    
    function updateSummary() {
      const summary = document.getElementById('summary');
      summary.innerHTML = '';
      const items = [
        ['Original', parseInt(document.getElementById('op9u').value || 0)],
        ['Mindset', parseInt(document.getElementById('kg3w').value || 0)],
        ['Dream', parseInt(document.getElementById('79Ki').value || 0)],
        ['Sky', parseInt(document.getElementById('qA18').value || 0)],
        ['Original Pre-Mix', parseInt(document.getElementById('2yGP').value || 0)],
        ['Eclipse', parseInt(document.getElementById('ecl1').value || 0)],
        ['Eclipse Pre-Mix', parseInt(document.getElementById('ecl2').value || 0)],
        ['Mindset Pre-Mix', parseInt(document.getElementById('woFY').value || 0)],
        ['Dream Pre-Mix', parseInt(document.getElementById('iZPh').value || 0)],
        ['Sky Pre-Mix', parseInt(document.getElementById('a4mQ').value || 0)],
        ['Vodka (doos)', parseInt(document.getElementById('hdRi').value || 0)],
        ['Gin (doos)', parseInt(document.getElementById('4w6u').value || 0)],
        ['Vodka 3L (Fles)', parseInt(document.getElementById('eFfE').value || 0)]
      ];
      let total = 0;
      items.forEach(([name, qty]) => {
        if (qty > 0) {
          const line = document.createElement('div');
          const cost = qty * 10;
          line.textContent = `${name}: ‚Ç¨${cost}`;
          summary.appendChild(line);
          total += cost;
        }
      });
      const totLine = document.createElement('div');
      totLine.className = 'summary-item';
      totLine.innerHTML = `<strong>Totaal: ‚Ç¨${total}</strong>`;
      summary.appendChild(totLine);
    }
    
    async function submitForm() {
  const submitBtn = document.getElementById("submitBtn");
  if (submitBtn) {
    submitBtn.disabled = true;
    submitBtn.innerText = "Versturen...";
  }

  // ‚úÖ Controleer of totaalbedrag minimaal ‚Ç¨100 is
  const totaalElement = document.querySelector('.overzicht-totaal');
  if (totaalElement) {
    const bedragText = totaalElement.innerText.replace(/[^0-9,]/g, '').replace(',', '.');
    const bedrag = parseFloat(bedragText);

    if (isNaN(bedrag) || bedrag < 100) {
      document.getElementById("warningPopup").style.display = "flex";
      if (submitBtn) {
        submitBtn.disabled = false;
        submitBtn.innerText = "Verstuur";
      }
      return;
    }
  }

  function closeWarningPopup() {
  document.getElementById("warningPopup").style.display = "none";
}


  const sigInput = document.getElementById('signatureData');
  if (sigInput) sigInput.value = canvas.toDataURL();

  const responses = [];
  const multiplyByTwo = ['op9u', 'kg3w', '79Ki', 'qA18', 'ecl1', '2yGP', 'woFY', 'a4mQ', 'ecl2'];

// Voeg vaste waarde toe voor kkX1
responses.push({ id: "kkX1", value: "Supermarkt" })

  for (const [domId, widgetId] of Object.entries(FIELD_MAP)) {
    const el = document.getElementById(domId);
    if (!el) continue;

    if (domId === 'selectedDisplay' && !el.value) continue;

    let value = el.value;

    if (multiplyByTwo.includes(domId)) {
      const numberVal = parseInt(el.value, 10);
      value = isNaN(numberVal) ? 0 : numberVal * 2;
    }

    responses.push({ id: widgetId, value: value.toString() });
  }

  const payload = {
    questions: responses,
    company: document.getElementById('companyName')?.value || '',
    phone: document.getElementById('phone')?.value || '',
    order_id: Math.random().toString(36).substring(2, 10)
  };
  
  try {
  const response = await fetch("https://gold-jkva.onrender.com/api/handle-order", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  const result = await response.text();
  console.log("Server response:", result); // optioneel

  if (response.ok) {
    if (submitBtn) submitBtn.disabled = false;

    document.getElementById("successPopup").style.display = "block";
    setTimeout(() => {
      document.getElementById("successPopup").style.display = "none";
      location.reload(); // of redirect
    }, 4000);
  } else {
    document.getElementById("errorPopup").style.display = "block";
  }

} catch (err) {
  console.error("Verzendfout:", err);
  document.getElementById("errorPopup").style.display = "block";
}
}

    
const canvas = document.getElementById("signature");
  const ctx = canvas.getContext("2d");
  let drawing = false;

  // Begin tekenen
  canvas.addEventListener("mousedown", (e) => {
    drawing = true;
    ctx.beginPath();
    ctx.moveTo(e.offsetX, e.offsetY);
  });

  // Tekenen tijdens muisbeweging
  canvas.addEventListener("mousemove", (e) => {
    if (!drawing) return;
    ctx.lineWidth = 2;
    ctx.lineCap = "round";
    ctx.strokeStyle = "#000";
    ctx.lineTo(e.offsetX, e.offsetY);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(e.offsetX, e.offsetY);
  });

  // Stop tekenen
  canvas.addEventListener("mouseup", () => {
    drawing = false;
  });
  canvas.addEventListener("mouseout", () => {
    drawing = false;
  });

  // Wissen
  function clearCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    document.getElementById("signatureData").value = ""; // optioneel ook input leegmaken
  }

    
    const SHEETS = [
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd5l-abTTXYY_T4d2iJoLewaNseO_2UH6OoiCiCEWfjP_3T6cbUVd4WQp6QjnS_aoCRfwqgEZRchsv/pubhtml?gid=51926634&single=true',
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd5l-abTTXYY_T4d2iJoLewaNseO_2UH6OoiCiCEWfjP_3T6cbUVd4WQp6QjnS_aoCRfwqgEZRchsv/pubhtml?gid=629687264&single=true',
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd5l-abTTXYY_T4d2iJoLewaNseO_2UH6OoiCiCEWfjP_3T6cbUVd4WQp6QjnS_aoCRfwqgEZRchsv/pubhtml?gid=1984994851&single=true',
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd5l-abTTXYY_T4d2iJoLewaNseO_2UH6OoiCiCEWfjP_3T6cbUVd4WQp6QjnS_aoCRfwqgEZRchsv/pubhtml?gid=1867508359&single=true',
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd5l-abTTXYY_T4d2iJoLewaNseO_2UH6OoiCiCEWfjP_3T6cbUVd4WQp6QjnS_aoCRfwqgEZRchsv/pubhtml?gid=0&single=true',
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd5l-abTTXYY_T4d2iJoLewaNseO_2UH6OoiCiCEWfjP_3T6cbUVd4WQp6QjnS_aoCRfwqgEZRchsv/pubhtml?gid=790443615&single=true',
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd5l-abTTXYY_T4d2iJoLewaNseO_2UH6OoiCiCEWfjP_3T6cbUVd4WQp6QjnS_aoCRfwqgEZRchsv/pubhtml?gid=690258645&single=true',
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd5l-abTTXYY_T4d2iJoLewaNseO_2UH6OoiCiCEWfjP_3T6cbUVd4WQp6QjnS_aoCRfwqgEZRchsv/pubhtml?gid=1028454158&single=true',
  'https://docs.google.com/spreadsheets/d/e/2PACX-1vQd5l-abTTXYY_T4d2iJoLewaNseO_2UH6OoiCiCEWfjP_3T6cbUVd4WQp6QjnS_aoCRfwqgEZRchsv/pubhtml?gid=1608034829&single=true'
];

const lookupMap = new Map();
async function loadSheets() {
  const progressBar = document.getElementById("progressBar");
  const loaderText = document.getElementById("filiaalLoader");
  const input = document.getElementById("2fC3");

  const CONTACT_GIDS = [
    "1028454158",
    "1608034829",
    "690258645",
    "790443615",
    "0"
  ];
  const totalSheets = SHEETS.length;
  let loadedSheets = 0;

  for (const url of SHEETS) {
    try {
      const resp = await fetch(url);
      const text = await resp.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(text, 'text/html');
      const rows = Array.from(doc.querySelectorAll('table tr'));

      const isContactSheet = CONTACT_GIDS.some(gid => url.includes(`gid=${gid}`));

      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (!cells.length) return;

        const id = cells[0].textContent.trim();
        const entry = {
          companyName: cells[1]?.textContent.trim() || "",
          adres: cells[2]?.textContent.trim() || "",
          postcode: cells[3]?.textContent.trim() || "",
          city: cells[4]?.textContent.trim() || "",
          provincie: cells[11]?.textContent.trim() || ""
        };

        if (isContactSheet) {
          entry.email = cells[13]?.textContent.trim() || "";
          entry.firstName = cells[14]?.textContent.trim() || "";
          entry.lastName = cells[15]?.textContent.trim() || "";
          entry.phone = cells[16]?.textContent.trim() || "";
        }

        lookupMap.set(id, entry);
      });

      // ‚úÖ Update voortgang
      loadedSheets++;
      const percentage = Math.round((loadedSheets / totalSheets) * 100);
      if (progressBar) progressBar.style.width = `${percentage}%`;
      if (loaderText) loaderText.innerText = `Laden winkeldata... (${percentage}%)`;

    } catch (e) {
      console.error("Fout bij laden sheet:", url, e);
    }
  }

  // ‚úÖ Klaar met laden
  if (loaderText) loaderText.innerText = "Data geladen. Vul ID in.";
  if (input) {
    input.disabled = false;
    input.style.backgroundColor = '#1d1d1d';
    input.style.color = '#fff';
    setTimeout(() => input.focus(), 300);
  }
}



    function updateTotal(id, price) {
  const qty = parseInt(document.getElementById(id).value || 0);
  const total = qty * price;
  const display = document.getElementById(id + 'Total');
  if (display) {
    display.textContent = '‚Ç¨' + total.toFixed(2).replace('.', ',');
  }

  // Werk ook het overzicht bij
  updateOrderOverview();
}

function updateOrderOverview() {
  const overzicht = document.getElementById('summary');
  overzicht.innerHTML = '';

  const items = [
    { id: 'op9u', name: 'Aantal tray Original', price: 26.88 },
    { id: 'kg3w', name: 'Aantal tray Mindset', price: 26.88 },
    { id: '79Ki', name: 'Aantal tray Dream', price: 26.88 },
    { id: 'qA18', name: 'Aantal tray Sky', price: 26.88 },
    { id: 'ecl1', name: 'Aantal tray Eclipse', price: 26.88 },
    { id: '2yGP', name: 'Aantal tray Original Pre-mix', price: 35.28 },
    { id: 'woFY', name: 'Aantal tray Mindset Pre-mix', price: 35.28 },
    { id: 'iZPh', name: 'Aantal tray Dream Pre-mix', price: 35.28 },
    { id: 'a4mQ', name: 'Aantal tray Sky Pre-mix', price: 35.28 },
    { id: 'ecl2', name: 'Aantal tray Eclipse Pre-mix', price: 35.28 },
    { id: 'hdRi', name: 'Aantal dozen Vodka', price: 150.42 },
    { id: '4w6u', name: 'Aantal dozen Gin', price: 150.42 },
    { id: 'eFfE', name: 'Aantal Vodka 3L', price: 135 }
  ];

  let totaal = 0;

  items.forEach(({ id, name, price }) => {
    const el = document.getElementById(id);
    if (!el) return;

    const qty = parseInt(el.value || 0);
    if (qty > 0) {
      const regel = document.createElement('div');
      regel.className = 'overzicht-item';
      regel.innerHTML = `<strong>${name}:</strong><br>${qty}`;
      overzicht.appendChild(regel);
      totaal += qty * price;
    }
  });

  const lijn = document.createElement('hr');
  lijn.style.margin = '2rem 0';
  overzicht.appendChild(lijn);

  const totaalRegel = document.createElement('div');
  totaalRegel.className = 'overzicht-totaal';
  totaalRegel.innerHTML = `<strong>Totaal: ${totaal.toFixed(2).replace('.', ',')}</strong>`;
  overzicht.appendChild(totaalRegel);
}


    

async function lookupFiliaal() {
  if (!lookupMap.size) await loadSheets();

  const filiaalId = document.getElementById('2fC3').value.trim();

  // Mapping: HTML input ID ‚Üí veldnaam in lookupMap
  const fieldMap = {
    companyName: 'companyName',
    address: 'adres',
    postcode: 'postcode',
    city: 'city',
    provincie: 'provincie',
    email: 'email',
    gWe8: 'firstName',       // voornaam
    ajwm: 'lastName',        // achternaam
    phone: 'phone'
  };

  if (lookupMap.has(filiaalId)) {
    const data = lookupMap.get(filiaalId);

    // Vul de velden in
    for (const [inputId, dataKey] of Object.entries(fieldMap)) {
      const el = document.getElementById(inputId);
      if (el) el.value = data[dataKey] || '';
    }
  } else {
    // Geen match ‚Üí wis alle velden
    for (const inputId of Object.keys(fieldMap)) {
      const el = document.getElementById(inputId);
      if (el) el.value = '';
    }
  }
}


    loadSheets();
    document.getElementById('submitBtn').addEventListener('click', submitForm);
    
</script>
</div>
</body>
</html>
